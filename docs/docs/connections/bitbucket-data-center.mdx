---
title: Linking code from Bitbucket Data Center
sidebarTitle: Bitbucket Data Center
icon: Bitbucket
---

import BitbucketSchema from '/snippets/schemas/v3/bitbucket.schema.mdx'

<Note>
Looking for docs on Bitbucket Cloud? See [this doc](/docs/connections/bitbucket-cloud).
</Note>

If you're not familiar with Sourcebot [connections](/docs/connections/overview), please read that overview first.

## Examples

<AccordionGroup>
    <Accordion title="Sync individual repos">
        ```json
        {
            "type": "bitbucket",
            "deploymentType": "server",
            "url": "https://mybitbucketdeployment.com",
            "repos": [
                "myProject/myRepo"
            ]
        }
        ```
    </Accordion>
    <Accordion title="Sync all repos in a project">
        ```json
        {
            "type": "bitbucket",
            "deploymentType": "server",
            "url": "https://mybitbucketdeployment.com",
            "projects": [
                "myProject"
            ]
        }
        ```
    </Accordion>
    <Accordion title="Exclude repos from syncing">
        ```json
        {
            "type": "bitbucket",
            "deploymentType": "server",
            "url": "https://mybitbucketdeployment.com",
            // Include all repos in myProject...
            "projects": [
                "myProject"
            ],
            // ...except:
            "exclude": {
                // repos that are archived
                "archived": true,
                // repos that are forks
                "forks": true,
                // repos that match these glob patterns
                "repos": [
                    "myProject/repo1",
                    "myProject2/*"
                ]
            }
        }
        ```
    </Accordion>
</AccordionGroup>

## Authenticating with Bitbucket Data Center

In order to index private repositories, you'll need to provide an access token to Sourcebot via a [token](/docs/configuration/config-file#tokens).

Create an access token for the desired scope (repo, project, or workspace). Visit the official [Bitbucket Data Center docs](https://confluence.atlassian.com/bitbucketserver/http-access-tokens-939515499.html)
for more info.

1. Add the `token` property to your connection config:

```json
{
    "type": "bitbucket",
    "deploymentType": "server",
    "url": "https://mybitbucketdeployment.com",
    "token": {
        // note: this env var can be named anything. It
        // doesn't need to be `BITBUCKET_TOKEN`.
        "env": "BITBUCKET_TOKEN"
    }
    // .. rest of config ..
}
```

2. Pass this environment variable each time you run Sourcebot:

```bash
docker run \
    -e BITBUCKET_TOKEN=<ACCESS_TOKEN> \
    /* additional args */ \
    ghcr.io/sourcebot-dev/sourcebot:latest
```

## Troubleshooting
If you're seeing errors like `TypeError: fetch failed` when fetching repo info, it may be that Sourcebot is refusing to connect to your self-hosted Bitbucket instance due to unrecognized SSL certs. Try setting the `NODE_TLS_REJECT_UNAUTHORIZED=0` environment variable or providing Sourcebot your certs through the `NODE_EXTRA_CA_CERTS` environment variable.



## Schema reference

<Accordion title="Reference">
[schemas/v3/bitbucket.json](https://github.com/sourcebot-dev/sourcebot/blob/main/schemas/v3/bitbucket.json)

<BitbucketSchema />

</Accordion>